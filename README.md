# NomadDays - Telegram Mini App –¥–ª—è Digital Nomads

Telegram Mini App –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –¥–Ω–µ–π –ø–æ —Å—Ç—Ä–∞–Ω–∞–º –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–µ–∑–¥–æ–∫ —Å —É—á—ë—Ç–æ–º –ø—Ä–∞–≤–∏–ª —Ä–µ–∑–∏–¥–µ–Ω—Ü–∏–∏.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–£—á—ë—Ç –¥–Ω–µ–π –ø–æ —Å—Ç—Ä–∞–Ω–∞–º**: –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –¥–Ω–µ–π –ø—Ä–µ–±—ã–≤–∞–Ω–∏—è
- **–ü—Ä–æ–≥–Ω–æ–∑ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –¥–Ω–µ–π**: –†–∞—Å—á—ë—Ç –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –¥–Ω–µ–π –ø–æ –ø—Ä–∞–≤–∏–ª–∞–º (90/180, 183 –¥–Ω—è –∏ –¥—Ä.)
- **–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –ø–æ–µ–∑–¥–æ–∫**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ø–ª–∞–Ω–∏—Ä—É–µ–º—ã—Ö –ø–æ–µ–∑–¥–æ–∫
- **–ò–º–ø–æ—Ä—Ç/–≠–∫—Å–ø–æ—Ä—Ç**: CSV –∑–∞–≥—Ä—É–∑–∫–∞ –∏ –≤—ã–≥—Ä—É–∑–∫–∞ –ø–æ–µ–∑–¥–æ–∫
- **–õ–æ–∫–∞–ª—å–Ω–∞—è –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å**: –î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ —Å –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- **Frontend**: Next.js 15 + App Router, React, TypeScript
- **Backend**: Next.js API Routes, Prisma ORM
- **Database**: SQLite (dev) / PostgreSQL (prod)
- **Telegram**: WebApp SDK, HMAC –≤–∞–ª–∏–¥–∞—Ü–∏—è initData
- **Rules Engine**: –ú–æ–¥—É–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–∞—Å—á—ë—Ç–∞ –ø—Ä–∞–≤–∏–ª —Ä–µ–∑–∏–¥–µ–Ω—Ü–∏–∏

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
/app
  /(webapp)          # –°—Ç—Ä–∞–Ω–∏—Ü—ã Mini App
  /api               # API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
/core
  /rules             # –î–≤–∏–∂–æ–∫ –ø—Ä–∞–≤–∏–ª –∏ —Ä–∞—Å—á—ë—Ç–æ–≤
  /tests             # Unit —Ç–µ—Å—Ç—ã
/components          # React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
/lib                 # –£—Ç–∏–ª–∏—Ç—ã –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
/prisma              # –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
/scripts             # –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è –ë–î
```

## üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
git clone <repository-url>
cd nomaddays
pnpm install
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
cp env.example .env.local
```

–ó–∞–ø–æ–ª–Ω–∏—Ç–µ `.env.local`:
```env
BOT_TOKEN=your_telegram_bot_token
WEBAPP_SECRET=your_webapp_secret
DATABASE_URL="file:./dev.db"
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Prisma –∫–ª–∏–µ–Ω—Ç–∞
pnpm db:generate

# –°–æ–∑–¥–∞–Ω–∏–µ –∏ –º–∏–≥—Ä–∞—Ü–∏—è –ë–î
pnpm db:migrate

# –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
pnpm db:seed
```

### 4. –ó–∞–ø—É—Å–∫

```bash
# –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
pnpm dev

# –°–±–æ—Ä–∫–∞
pnpm build

# –ü—Ä–æ–¥–∞–∫—à–Ω
pnpm start
```

## ü§ñ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram Bot

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –±–æ—Ç–∞

1. –ù–∞–ø–∏—à–∏—Ç–µ [@BotFather](https://t.me/botfather) –≤ Telegram
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–≥–æ –±–æ—Ç–∞: `/newbot`
3. –ü–æ–ª—É—á–∏—Ç–µ `BOT_TOKEN`

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ WebApp

1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ BotFather: `/setmenubutton`
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
3. –í—ã–±–µ—Ä–∏—Ç–µ "Configure Menu Button"
4. –í–≤–µ–¥–∏—Ç–µ URL: `https://your-domain.com/`
5. –í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏: "NomadDays"

### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ WebApp Secret

1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ BotFather: `/mybots`
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
3. Bot Settings ‚Üí API Token
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `WEBAPP_SECRET`

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
pnpm test

# –¢–µ—Å—Ç—ã –≤ —Ä–µ–∂–∏–º–µ watch
pnpm test:watch
```

## üìä –ü—Ä–∞–≤–∏–ª–∞ —Ä–µ–∑–∏–¥–µ–Ω—Ü–∏–∏

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ç–∏–ø—ã

- **–°–∫–æ–ª—å–∑—è—â–µ–µ –æ–∫–Ω–æ**: N –¥–Ω–µ–π –∏–∑ M –¥–Ω–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, 90/180)
- **–ö–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã–π –≥–æ–¥**: –ú–∞–∫—Å–∏–º—É–º –¥–Ω–µ–π –≤ –≥–æ–¥—É
- **–°–∫–æ–ª—å–∑—è—â–∏–µ 12 –º–µ—Å—è—Ü–µ–≤**: 183 –¥–Ω—è –≤ –ª—é–±—ã–µ 12 –º–µ—Å—è—Ü–µ–≤
- **–ú–∞–∫—Å–∏–º—É–º –≤–Ω–µ —Å—Ç—Ä–∞–Ω—ã**: –î–ª—è —Ç–µ—Å—Ç–æ–≤ —Ä–µ–∑–∏–¥–µ–Ω—Ü–∏–∏

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤–∏–ª

–í—Å–µ –ª–∏–º–∏—Ç—ã –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –≤ `core/rules/presets.ts`:

```typescript
KZ_RESIDENCY_TEST: {
  name: '–¢–µ—Å—Ç —Ä–µ–∑–∏–¥–µ–Ω—Ü–∏–∏ –†–ö',
  maxDaysOutside: 183, // TODO: –£—Ç–æ—á–Ω–∏—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
  calendarYear: true
}
```

‚ö†Ô∏è **–í–∞–∂–Ω–æ**: –í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è —è–≤–ª—è—é—Ç—Å—è –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏. –ò–∑–º–µ–Ω–∏—Ç–µ –∏—Ö –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ –≤–∞—à–µ–π —é—Ä–∏—Å–¥–∏–∫—Ü–∏–∏.

## üöÄ –î–µ–ø–ª–æ–π

### Vercel (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∫ Vercel
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
   - `BOT_TOKEN`
   - `WEBAPP_SECRET`
   - `DATABASE_URL` (PostgreSQL)
3. –î–µ–ø–ª–æ–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏ push –≤ main

### –î—Ä—É–≥–∏–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã

- **Railway**: –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç PostgreSQL
- **Render**: –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π PostgreSQL
- **DigitalOcean**: App Platform + Managed Database

## üì± –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ –±–æ—Ç–∞ –≤ Telegram
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "NomadDays"
3. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å —á–µ—Ä–µ–∑ Telegram
4. –î–æ–±–∞–≤—å—Ç–µ –ø–æ–µ–∑–¥–∫–∏ –∏–ª–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ CSV
5. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞
6. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –í–∞–ª–∏–¥–∞—Ü–∏—è Telegram initData —á–µ—Ä–µ–∑ HMAC-SHA256
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –æ–±–ª–∞—á–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

## ü§ù –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –ö–æ–º–∞–Ω–¥—ã

```bash
pnpm dev              # –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
pnpm build            # –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
pnpm start            # –ó–∞–ø—É—Å–∫ –ø—Ä–æ–¥–∞–∫—à–Ω –≤–µ—Ä—Å–∏–∏
pnpm lint             # –ü—Ä–æ–≤–µ—Ä–∫–∞ ESLint
pnpm format           # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Prettier
pnpm test             # –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
pnpm db:studio        # Prisma Studio
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø—Ä–∞–≤–∏–ª

1. –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–∞–≤–∏–ª–æ –≤ `core/rules/presets.ts`
2. –î–æ–±–∞–≤—å—Ç–µ –ª–æ–≥–∏–∫—É –≤ `core/rules/engine.ts`
3. –ù–∞–ø–∏—à–∏—Ç–µ —Ç–µ—Å—Ç—ã –≤ `core/tests/rules.spec.ts`
4. –û–±–Ω–æ–≤–∏—Ç–µ —Ç–∏–ø—ã –≤ `core/rules/types.ts`

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

## üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- Issues: GitHub Issues
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: README.md
- Telegram: @your_username

---

**‚ö†Ô∏è –î–∏—Å–∫–ª–µ–π–º–µ—Ä**: –î–∞–Ω–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–æ –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ü–µ–ª–µ–π. –í—Å–µ –ø—Ä–∞–≤–∏–ª–∞ –∏ –ª–∏–º–∏—Ç—ã —è–≤–ª—è—é—Ç—Å—è –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏. –ü—Ä–æ–∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä—É–π—Ç–µ—Å—å —Å —é—Ä–∏—Å—Ç–æ–º –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–∞–≤–æ–≤—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –ø–æ –≤–∞—à–µ–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏.
